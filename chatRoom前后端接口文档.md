

# chatRoom前后端接口文档

地址：localhost:3000

## 注册模块

### 1.用户注册

地址：/sign/signUp

请求方式：POST

参数：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
| username |  string  |  用户名  |    是    |
| password |  string  |   密码   |    是    |
|   mail   |  string  |   邮箱   |    是    |

返回值：

| **字段** | **类型** |               **说明**                | **必须** |
| :------: | :------: | :-----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功，错误] |    是    |

### 2.邮箱/用户是否存在验证

地址：/sign/judge

请求方式：POST

参数：

| **字段** | **类型** |   **说明**    | **必须** |
| :------: | :------: | :-----------: | :------: |
|   type   |  string  |  邮箱/用户名  |    是    |
|   data   |  string  | username/mail |    是    |

返回值：

| **字段** | **类型** |               **说明**               | **必须** |
| :------: | :------: | :----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |
|  result  |   int    |              存在的数量              |    是    |

## 登录模块

### 1.登录

地址：/sign/siginIn

请求方式：POST

参数：

| **字段** | **类型** |     **说明**     | **必须** |
| :------: | :------: | :--------------: | :------: |
|   data   |  string  | 邮箱/用户名/手机 |    是    |
| password |  string  |       密码       |    是    |

返回值：

| **字段** | **类型** |                           **说明**                           | **必须** |
| :------: | :------: | :----------------------------------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/403/405/500<br />[成功/密码错误/用户不存在/错误] |    是    |
|    id    |  string  |                            用户ID                            |    是    |
| username |  string  |                            用户名                            |    是    |
| icon_url |  string  |                           头像地址                           |    是    |
|  token   |  string  |                          凭证token                           |    是    |

## 搜索模块

### 1.搜索用户

地址：/search/user

请求方式：POST

参数：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
|   data   |  string  |  关键字  |    是    |

返回值：

| **字段** | **类型** |               **说明**               | **必须** |
| :------: | :------: | :----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |
|  result  |   list   |          符合条件的用户列表          |    是    |

### 2.判断是否为好友

地址：/search/isfriend

请求方式：POST

参数：

| **字段** | **类型** |  **说明**  | **必须** |
| :------: | :------: | :--------: | :------: |
|   uid    |  string  |   用户ID   |    是    |
|   fid    |  string  | 对象用户ID |    是    |

返回值：

| **字段** | **类型** |                    **说明**                     | **必须** |
| :------: | :------: | :---------------------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/405/500<br />[成功/非好友/错误] |    是    |

### 3.搜索群组

地址：/search/group

请求方式：POST

参数：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
|   data   |  string  |  关键字  |    是    |

返回值：

| **字段** | **类型** |               **说明**               | **必须** |
| :------: | :------: | :----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |
|  result  |   list   |          符合条件的群组列表          |    是    |

### 4.判断是否在群内

地址：/search/isingroup

请求方式：POST

参数：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
|   uid    |  string  |  用户ID  |    是    |
|   gid    |  string  |  群组ID  |    是    |

返回值：

| **字段** | **类型** |                    **说明**                     | **必须** |
| :------: | :------: | :---------------------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/405/500<br />[成功/非群内/错误] |    是    |

## 用户模块

### 1.用户详情

地址：/user/detail

请求方式：POST

参数：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
|    id    |  string  |  用户ID  |    是    |

返回值：

|  **字段**   | **类型** |               **说明**               | **必须** |
| :---------: | :------: | :----------------------------------: | :------: |
|   status    |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |
|     _id     |  string  |                用户ID                |    是    |
|  username   |  string  |                用户名                |    是    |
|    mail     |  string  |                 邮箱                 |    否    |
|   mobile    |  string  |                 手机                 |    否    |
|     sex     |   int    |                 性别                 |    是    |
|    birth    |  string  |                 生日                 |    否    |
|   explain   |  string  |                 介绍                 |    否    |
|  icon_url   |  string  |               头像地址               |    是    |
| create_time |  string  |               创建日期               |    是    |

### 2.用户信息修改

地址： 

请求方式：POST

参数：

| **字段** | **类型** |    **说明**    | **必须** |
| :------: | :------: | :------------: | :------: |
|    id    |  string  |     用户ID     |    是    |
|   type   |  string  | 修改属性的字段 |    是    |
|   data   |  string  |  修改属性的值  |    是    |
| password |  string  |      密码      |    否    |

返回值：

| **字段** | **类型** |                           **说明**                           | **必须** |
| :------: | :------: | :----------------------------------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/403/405/500<br />[成功/已存在/密码错误/错误] |    是    |

### 3.获取用户好友昵称

地址：/user/getNickname

请求方式：POST

参数：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
|   uid    |  string  |  用户ID  |    是    |
|   fid    |  string  |  好友ID  |    是    |

返回值：

| **字段** | **类型** |               **说明**               | **必须** |
| :------: | :------: | :----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |
|  result  |  object  |                 昵称                 |    是    |

### 4.用户好友昵称修改

地址：/user/setNickname

请求方式：POST

参数：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
|   uid    |  string  |  用户ID  |    是    |
|   fid    |  string  |  好友ID  |    是    |
| nickname |  string  |   昵称   |    是    |

返回值：

| **字段** | **类型** |               **说明**               | **必须** |
| :------: | :------: | :----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |

## 好友模块

### 1.申请好友

地址：/friend/apply

请求方式：POST

参数：

| **字段** | **类型** |     **说明**     | **必须** |
| :------: | :------: | :--------------: | :------: |
|   uid    |  string  |      用户ID      |    是    |
|   fid    |  string  |    申请好友ID    |    是    |
| message  |  string  | 发送好友申请内容 |    是    |

返回值：

| **字段** | **类型** |               **说明**               | **必须** |
| :------: | :------: | :----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |

### 2.接受好友申请

地址：/friend/updateState

请求方式：POST

参数：

| **字段** | **类型** |  **说明**  | **必须** |
| :------: | :------: | :--------: | :------: |
|   uid    |  string  |   用户ID   |    是    |
|   fid    |  string  | 申请好友ID |    是    |

返回值：

| **字段** | **类型** |               **说明**               | **必须** |
| :------: | :------: | :----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |

### 3.拒绝/删除好友

地址：/friend/delete

请求方式：POST

参数：

| **字段** | **类型** |  **说明**  | **必须** |
| :------: | :------: | :--------: | :------: |
|   uid    |  string  |   用户ID   |    是    |
|   fid    |  string  | 申请好友ID |    是    |

返回值：

| **字段** | **类型** |               **说明**               | **必须** |
| :------: | :------: | :----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |

## 文件上传模块

### 1.文件上传

地址：/files/upload

请求方式：POST

参数：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
|   url    |  string  |   路径   |    是    |
|   name   |  string  |  文件名  |    是    |
|  files   |  files   |   文件   |    是    |

返回值：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
|  imgUrl  |  string  | 文件路径 |    是    |

## 首页模块

### 1.获取好友列表

地址：/home/getfriend

请求方式：POST

参数：

| **字段** | **类型** |   **说明**   | **必须** |
| :------: | :------: | :----------: | :------: |
|   uid    |  string  |    用户ID    |    是    |
|  state   |  number  | 好友关系类型 |    是    |

返回值：

| **字段** | **类型** |               **说明**               | **必须** |
| :------: | :------: | :----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |
|  result  |   list   |             好友列表数据             |    是    |

### 2.获取好友最后一条消息

地址：/home/getlastmsg

请求方式：POST

参数：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
|   uid    |  string  |  用户ID  |    是    |
|   fid    |  string  |  好友ID  |    是    |

返回值：

|  **字段**   | **类型** |               **说明**               | **必须** |
| :---------: | :------: | :----------------------------------: | :------: |
|   status    |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |
|   message   |  string  |               消息内容               |    是    |
| create_time |   date   |               发送时间               |    是    |
|    types    |  number  |               消息类型               |    是    |

### 3.获取一对一未读消息数

地址：/home/unreadmsg

请求方式：POST

参数：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
|   uid    |  string  |  用户ID  |    是    |
|   fid    |  string  |  好友ID  |    是    |

返回值：

| **字段** | **类型** |               **说明**               | **必须** |
| :------: | :------: | :----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |
|  result  |   list   |             未读消息数量             |    是    |

### 4.一对一未读消息已读

地址：/home/updatemsg

请求方式：POST

参数：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
|   uid    |  string  |  用户ID  |    是    |
|   fid    |  string  |  好友ID  |    是    |

返回值：

| **字段** | **类型** |               **说明**               | **必须** |
| :------: | :------: | :----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |

### 5.获取群列表

地址：/home/getgroup

请求方式：POST

参数：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
|   uid    |  string  |  用户ID  |    是    |

返回值：

| **字段** | **类型** |               **说明**               | **必须** |
| :------: | :------: | :----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |
|  result  |   list   |              群列表数据              |    是    |

### 6.获取最后一条群消息

地址：/home/getgrouplastmsg

请求方式：POST

参数：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
|   gid    |  string  |  群组ID  |    是    |

返回值：

|  **字段**   | **类型** |               **说明**               | **必须** |
| :---------: | :------: | :----------------------------------: | :------: |
|   status    |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |
|   message   |  string  |               消息内容               |    是    |
| create_time |   date   |               发送时间               |    是    |
|    types    |  number  |               消息类型               |    是    |
|  username   |  string  |               发送用户               |    是    |

### 7.群消息已读

地址：/home/updategroupmsg

请求方式：POST

参数：

| **字段** | **类型** | **说明** | **必须** |
| :------: | :------: | :------: | :------: |
|   gid    |  string  |  群组ID  |    是    |
|   uid    |  string  |  用户ID  |    是    |

返回值：

| **字段** | **类型** |               **说明**               | **必须** |
| :------: | :------: | :----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |

## 聊天模块

### 1.获取聊天数据

地址：/chat/getmsg

请求方式：POST

参数：

|  **字段**   | **类型** |  **说明**  | **必须** |
| :---------: | :------: | :--------: | :------: |
|     uid     |  string  |   用户ID   |    是    |
|     fid     |  string  |   好友ID   |    是    |
| currentPage |   int    |    页码    |    是    |
|  pageSize   |   int    | 一页的数量 |    是    |

：

| **字段** | **类型** |               **说明**               | **必须** |
| :------: | :------: | :----------------------------------: | :------: |
|  status  |   int    | 状态码<br />200/500<br />[成功/错误] |    是    |
|  result  |   list   |             消息列表数据             |    是    |

###

